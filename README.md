# Mutation Space
The mutation space of spatially conserved amino acid residues (MSSC) is a protein structural descriptor that characterizes the frequency and chemical change for amino acids in the context of relative spatial positions. The MSSC is analogous to scoring amino acid sites in a multiple sequence alignment but with three-dimensional space. 

### Dependencies
* Python 3.0 or after
* Libraries: argparse, pathlib, openpyxl, numpy, pandas, collections, math

## Summary
Additional details on the scripts and available functions may be seen in their help messages (e.g. `prep_FASTAs.py --help`) and in the *Example*.
* `prep_FASTAs.py` - Script that constructs a file containing the FASTA sequences for crystallographically resolved residues for the user-specified protein structures and chains. The generated file is suitable for sequence alignment by other programs.
* `calc_MSSC.py` - Script that computes the MSSC for the user-specified structures and chains. Requires a Multiple Sequence Alignment file of the structures (in ClustalW format) generated by another program (see for example MUSCLE or Clustal Omega of EMBL-EBI).
* `scoring_matrix.py` - Library that stores information on the distance scoring matrices used in computing the MSSC score (e.g. Grantham distance).

## Example
Demo files for using the scripts are provided under `example`.
### Preparing a FASTA file
MSSC scores are computed for residues successfully resolved in the X-ray crystal structures. The `prep_FASTAs.py` script will take structures listed in a user-provided file and generate a FASTA-formated file of the resolved amino acids. Non-standard residues present will be assigned the single letter *X* unless otherwise assigned by the `-a` flag. By default, the A chain residues are analyzed; an alternate chain may be used for a structure by indicating the chain letter after the structure name in the list file (see *example_pdb_list*). Example commands for preparing the FASTA file:

```
ls TE11_pdbs/*.pdb > pdb_list
prep_FASTAs.py pdb_list -a MSE:M
```
Several of the structures in this example contain selenomethionine (*MSE*), which is assigned *M*. The output file (*gen_FASTAs.dat*) my then be used for a multiple sequence alignment. 
### Calculating the MSSC
After aligning the sequences and saving the results in ClustalW format, the MSSC may be computed. The `calc_MSSC.py` script requires the list of the files (*pdb_list*), the multiple sequence alignment results (*example_MSE.dat*), and the target structure to serve as a reference. Example command:
```
calc_MSSC.py pdb_list example_MSE.dat TE11_pdbs/1SC0.pdb
```
The MSSC results and scores are computed and stored in the output (*results.xlsx*). Intermediary results are logged in the generated directory *processed_pdbs*.

The spatial alignment of the structures performed by the script can be disabled by using the `-noalign` flag. 

# Citation
The journal article reference for this work is:

